CREATE EXTENSION
Test 1: int2 with heavy duplicates (RLE compression)
DROP TABLE
CREATE TABLE
INSERT 0 10000
CREATE INDEX
 total_pages | leaf_pages | key_rle_pages | compression_pct | format_check 
-------------+------------+---------------+-----------------+--------------
           5 |          3 |             3 |             100 | RLE USED
(1 row)

 count 
-------
  5000
(1 row)

 count 
-------
  1000
(1 row)

 min | max | count 
-----+-----+-------
   0 |   9 | 10000
(1 row)

Test 2: int8 with heavy duplicates (RLE compression)
DROP TABLE
CREATE TABLE
INSERT 0 10000
CREATE INDEX
 total_pages | leaf_pages | key_rle_pages | compression_pct | format_check 
-------------+------------+---------------+-----------------+--------------
          12 |         10 |            10 |             100 | RLE USED
(1 row)

 count 
-------
  5000
(1 row)

 count 
-------
   500
(1 row)

Test 3: UUID with duplicates (RLE compression)
DROP TABLE
CREATE TABLE
INSERT 0 10000
CREATE INDEX
 total_pages | leaf_pages | key_rle_pages | compression_pct | format_check 
-------------+------------+---------------+-----------------+--------------
          22 |         20 |            20 |             100 | RLE USED
(1 row)

 count 
-------
  5000
(1 row)

 count 
-------
    10
(1 row)

Test 4: Text (8-byte) with duplicates (RLE compression)
DROP TABLE
CREATE TABLE
INSERT 0 10000
CREATE INDEX
 total_pages | leaf_pages | key_rle_pages | compression_pct | format_check 
-------------+------------+---------------+-----------------+--------------
          12 |         10 |            10 |             100 | RLE USED
(1 row)

 count 
-------
  6000
(1 row)

 count 
-------
  2000
(1 row)

Test 5: Text (16-byte) with duplicates (RLE compression)
DROP TABLE
CREATE TABLE
INSERT 0 10000
CREATE INDEX
 total_pages | leaf_pages | key_rle_pages | compression_pct | format_check 
-------------+------------+---------------+-----------------+--------------
          22 |         20 |            20 |             100 | RLE USED
(1 row)

 count 
-------
  6667
(1 row)

 count 
-------
  3333
(1 row)

Test 6: RLE with backward scans
SET
SET
 k | count 
---+-------
 0 |  1000
 1 |  1000
 2 |  1000
 3 |  1000
 4 |  1000
(5 rows)

 k | count 
---+-------
 9 |  1000
 8 |  1000
 7 |  1000
 6 |  1000
 5 |  1000
(5 rows)

Test 7: Verify RLE provides space savings
DROP TABLE
CREATE TABLE
INSERT 0 10000
CREATE INDEX
DROP TABLE
CREATE TABLE
INSERT 0 10000
CREATE INDEX
  case_name  | index_size | pages | rle_pages 
-------------+------------+-------+-----------
 with_rle    | 56 kB      |     5 |         5
 without_rle | 56 kB      |     5 |         0
(2 rows)

  space_check   
----------------
 RLE NO SAVINGS
(1 row)

RLE tests completed successfully!
